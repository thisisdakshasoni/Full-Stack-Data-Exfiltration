# Full Stack Data Exfiltration via Encrypted Mesh Network and SIEM Evasion ğŸ”’ğŸŒ

## **Project Overview** ğŸ¯
This project demonstrates a **Full Stack Data Exfiltration Tool** that uses **encrypted peer-to-peer connections** over a **containerized mesh**. The tool is designed to bypass **SIEM detection** and traditional perimeter monitoring techniques, employing advanced encryption and obfuscation methods.

**Objective**: Build a distributed tool for data exfiltration while maintaining security and evading detection from security monitoring systems such as **Wazuh** and **Suricata**.

## **Technologies Used** ğŸ› ï¸
- **Go** (for building the exfiltration agent)
- **WireGuard** (for encrypted peer-to-peer connections)
- **Prometheus** (for monitoring and metrics collection)
- **Grafana** (for visualizing metrics)
- **Wazuh** (for SIEM-based detection)
- **Suricata** (for network monitoring)
- **Docker** (for containerizing the application)
- **TLS** (for encrypting traffic)
- **Base64** (for data obfuscation)

## **Project Structure** ğŸ“
Hereâ€™s a breakdown of the key files and directories:
/project-root
â”œâ”€â”€ /agent # Go agent responsible for exfiltrating data
â”œâ”€â”€ /config # Configuration files for Wazuh, Prometheus, etc.
â”œâ”€â”€ /docker # Docker setup for mesh network and containers
â”œâ”€â”€ /scripts # Helper scripts (e.g., setup, start)
â”œâ”€â”€ /metrics # Metrics collection (Prometheus configuration)
â”œâ”€â”€ /logs # Logs generated by the system
â”œâ”€â”€ README.md # This file
â”œâ”€â”€ /wazuh-setup # Wazuh installation and configuration files
â””â”€â”€ /suricata-setup # Suricata installation and configuration files
## **Installation & Setup** âš™ï¸

### **1. Prerequisites** ğŸ“‹
- **Ubuntu 22.04** or any compatible Linux distribution
- **Docker** (for containerized mesh nodes)
- **Go** (for building the agent)
- **Prometheus** and **Grafana** for monitoring and visualization
- **Wazuh** and **Suricata** for SIEM detection

### **2. Setting up the Environment** ğŸ”§

#### **Clone the repository**:
```bash
git clone https://github.com/thisisdakshasoni/Full Stack Data Exfiltration.git
cd Full Stack Data Exfiltration
Building the Agent ğŸ–¥ï¸:
Install Go if not already installed:

sudo apt-get install golang-go
Build the agent:


go build -o agent main.go
The agent should now be ready to run.

Running Prometheus & Grafana ğŸ“Š:
Prometheus:

Ensure Prometheus is configured to scrape metrics from the agent:

yaml

scrape_configs:
  - job_name: 'exfil_agent'
    static_configs:
      - targets: ['192.168.x.x:2112']
Start Prometheus:

bash

docker-compose up -d prometheus
Grafana:

Set up Grafana dashboards to visualize the exfiltration data.

Add Prometheus as a data source and create the required panels.

Running Wazuh & Suricata ğŸ›¡ï¸:
Configure Wazuh to monitor for anomalies.

Set up Suricata for network monitoring and configure its rules to avoid false positives.

3. Running the Tool ğŸš€
Once everything is set up, run the agent:

bash
Copy
./agent
This will start the data exfiltration process and send data to the target URL using TLS encryption and base64 obfuscation.

4. Monitoring the Exfiltration ğŸ“ˆ
Go to Grafana and monitor the metrics at http://localhost:3000 to ensure the exfiltration is happening without triggering any alarms.

The data exfiltrated will be visible in Prometheus and Grafana, and you can track metrics like data_exfiltrated_bytes_total.

5. Testing Detection Systems ğŸ§ª
Ensure that Wazuh and Suricata do not flag the exfiltration attempt due to encryption and obfuscation.

Regular testing and fine-tuning of the detection rules may be required.


      
Testing ğŸ§‘â€ğŸ”¬
This project should be tested in an isolated environment to evaluate its performance and stealthiness. Use Suricata to simulate network traffic and Wazuh to detect abnormal activities. Adjust the detection rules to avoid false positives triggered by the toolâ€™s obfuscation and encryption.

Known Issues ğŸš¨
Wazuh may detect traffic if the configurations arenâ€™t tuned correctly.

Suricata may raise alerts if rules are too generic.

Docker networking can sometimes interfere with container-based setups, ensure proper networking configurations.
